<html>
<head>
    <title>Sensors</title>
</head>
<body>
<h1>Sensor Usage:</h1>
<h3>Absolute Orientation</h3>
<div id="absoluteOrientation"></div>
<h3>Accelerometer</h3>
<button onclick="accelerometerDemo()">Test</button>
<div id="accelerometer"></div>
<h3>Ambient Light</h3>
<button onclick="ambientLightDemo()">Test</button>
<div id="ambientLight"></div>
<h3>Gravity</h3>
<button onclick="gravityDemo()">Test</button>
<div id="gravity"></div>
<h3>Gyroscope</h3>
<button onclick="gyroscopeDemo()">Test</button>
<div id="gyroscope"></div>
<h3>Linear Acceleration</h3>
<button onclick="linearAccelerationDemo()">Test</button>
<div id="linearAcceleration"></div>
<h3>Magnetometer</h3>
<button onclick="magnetometerDemo()">Test</button>
<div id="magnetometer"></div>
<h3>Orientation</h3>
<button onclick="orientationDemo()">Test</button>
<div id="orientation"></div>
<h3>Relative Orientation</h3>
<button onclick="relativeOrientationDemo()">Test</button>
<div id="relativeOrientation"></div>
<script>
    function accelerometerDemo() {
        const options = {frequency: 60, referenceFrame: "device"};
        const sensor = new AbsoluteOrientationSensor(options);
        let accelDiv = document.getElementById("accelerometer");

        sensor.addEventListener("reading", () => {
            // model is a Three.js object instantiated elsewhere.
            model.quaternion.fromArray(sensor.quaternion).inverse();
        });
        sensor.addEventListener("error", (error) => {
            if (event.error.name === "NotReadableError") {
                accelDiv.innerHTML = " Accelerometer is not available."
            }
        });
        sensor.start();

        /*//accelerometer
        let accelerometerText = document.getElementById("accelerometer");
        const acl = new Accelerometer({frequency: 60});
        acl.addEventListener("reading", () => {
            console.log(`Acceleration along the X-axis ${acl.x}`);
            console.log(`Acceleration along the Y-axis ${acl.y}`);
            console.log(`Acceleration along the Z-axis ${acl.z}`);
            accelerometerText.innerHTML = `Acceleration along the X-axis ${acl.x} <br>Acceleration along the Y-axis ${acl.y} \n Acceleration along the Z-axis ${acl.z}`;
        });

        acl.start();*/

    }


    //ambientLight sensor
    function ambientLightDemo() {
        let ambientLightDiv = document.getElementById("ambientLight");
        if ("AmbientLightSensor" in window) {
            const sensor = new AmbientLightSensor();
            sensor.addEventListener("reading", (event) => {
                // console.log("Current light level:", sensor.illuminance);
                ambientLightDiv.innerHTML += "Current light level:" + sensor.illuminance;
            });
            sensor.addEventListener("error", (event) => {
                // console.log(event.error.name, event.error.message);
                ambientLightDiv.innerHTML = event.error.name + " " + event.error.message;
            });
            sensor.start();
        }
    }

    /*
        const sensor = new AbsoluteOrientationSensor();
        Promise.all([
            navigator.permissions.query({name: "accelerometer"}),
            navigator.permissions.query({name: "magnetometer"}),
            navigator.permissions.query({name: "gyroscope"}),
        ]).then((results) => {
            if (results.every((result) => result.state === "granted")) {
                sensor.start();
                // â€¦
            } else {
                console.log("No permissions to use AbsoluteOrientationSensor.");
            }
        });*/

    //gravity sensor
    function gravityDemo() {
        let gravityDiv = document.getElementById("gravity");
        let gravitySensor = new GravitySensor({frequency: 60});

        gravitySensor.addEventListener("reading", (e) => {
            gravityDiv.innerHTML = `Gravity along the X-axis ${gravitySensor.x}`;
            gravityDiv.innerHTML += `Gravity along the Y-axis ${gravitySensor.y}`;
            gravityDiv.innerHTML += `Gravity along the Z-axis ${gravitySensor.z}`;
            // console.log(`Gravity along the X-axis ${gravitySensor.x}`);
            // console.log(`Gravity along the Y-axis ${gravitySensor.y}`);
            // console.log(`Gravity along the Z-axis ${gravitySensor.z}`);
        });

        gravitySensor.start();
    }
</script>
</body>
</html>