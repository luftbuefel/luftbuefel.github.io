<html>
<head>
    <title>Sensors</title>
</head>
<body>
<h1>Sensor Usage:</h1>
<h3>Absolute Orientation</h3>
<div id="absoluteOrientation"></div>
<h3>Accelerometer</h3>
<button onclick="accelerometerDemo()">Test</button>
<div id="accelerometer"></div>
<h3>Ambient Light</h3>
<button onclick="ambientLightDemo()">Test</button>
<div id="ambientLight"></div>
<h3>Gravity</h3>
<button onclick="gravityDemo()">Test</button>
<div id="gravity"></div>
<h3>Gyroscope</h3>
<button onclick="gyroscopeDemo()">Test</button>
<div id="gyroscope"></div>
<h3>Linear Acceleration</h3>
<button onclick="linearAccelerationDemo()">Test</button>
<div id="linearAcceleration"></div>
<h3>Magnetometer</h3>
<button onclick="magnetometerDemo()">Test</button>
<div id="magnetometer"></div>
<h3>Orientation</h3>
<button onclick="orientationDemo()">Test</button>
<div id="orientation"></div>
<h3>Relative Orientation</h3>
<button onclick="relativeOrientationDemo()">Test</button>
<div id="relativeOrientation"></div>
<script>
    //accelerometer sensor
    function accelerometerDemo() {
        let accelDiv = document.getElementById("accelerometer");

        let options = {frequency: 60, referenceFrame: "device"};
        let sensor = new AbsoluteOrientationSensor(options);
        sensor.addEventListener("reading", () => {
            // model is a Three.js object instantiated elsewhere.
            model.quaternion.fromArray(sensor.quaternion).inverse();
            accelDiv.innerHTML = sensor.quaternion.toString();
        });
        sensor.addEventListener("error", (event) => {
            if (event.error.name === "NotReadableError") {
                accelDiv.innerHTML = " Accelerometer is not available. " + event.error.name + " " + event.error.message;
            }
        });
        sensor.start();
    }

    //ambientLight sensor
    function ambientLightDemo() {
        let ambientLightDiv = document.getElementById("ambientLight");

        let sensor = new AmbientLightSensor();
        sensor.addEventListener("reading", (event) => {
            ambientLightDiv.innerHTML = "Current light level:" + sensor.illuminance;
        });
        sensor.addEventListener("error", (event) => {
            ambientLightDiv.innerHTML = "Ambient light sensor is not available. " + event.error.name + " " + event.error.message;
        });
        sensor.start();
    }

    //gravity sensor
    function gravityDemo() {
        let gravityDiv = document.getElementById("gravity");

        let gravitySensor = new GravitySensor({frequency: 60});
        gravitySensor.addEventListener("reading", (e) => {
            gravityDiv.innerHTML="";
            if(findDown(gravitySensor)){
                gravityDiv.innerHTML+=`This is sitting on the ${findDown(gravitySensor)}.`;
            }
            gravityDiv.innerHTML += `Gravity<br>x: ${gravitySensor.x}<br>y: ${gravitySensor.y}<br>z: ${gravitySensor.z}`;
        });
        gravitySensor.addEventListener("error", (event) => {
            gravityDiv.innerHTML = "Gravity sensor is not available. " + event.error.name + " " + event.error.message;
        });
        gravitySensor.start();
    }
    
    function findDown(gravitySensor){
        if(gravitySensor.x>=9.7){
            return "left side";
        }
        if(gravitySensor.x<=-9.7){
            return "right side";
        }
        if(gravitySensor.y>=9.7){
            return "bottom side";
        }
        if(gravitySensor.y<=-9.7){
            return "top side";
        }
        if(gravitySensor.z>=9.7){
            return "back";
        }
        if(gravitySensor.z<=-9.7){
            return "front";
        }
    }

    //gyroscope sensor
    function gyroscopeDemo() {
        let gyroscopeDiv = document.getElementById("gyroscope");

        let gyroscope = new Gyroscope({frequency: 60});
        gyroscope.addEventListener("reading", (e) => {
            gyroscopeDiv.innerHTML = `Angular velocity<br>x: ${gyroscope.x}<br>y: ${gyroscope.y}<br>z: ${gyroscope.z}`;
        });     
        gyroscope.start();
    }
    
    //linear acceleration sensor
    function linearAccelerationDemo(){
        let linearAccelerationDiv = document.getElementById("linearAcceleration");
        linearAccelerationDiv.innerHTML="not implemented yet";
    }
    
    //magnetometer sensor
    function magnetometerDemo(){
        let magnetometerDiv = document.getElementById("magnetometer");
        magnetometerDiv.innerHTML="not implemented yet";
    }
    
    //orientation sensor
    function orientationDemo(){
        let orientationDiv = document.getElementById("orientation");
        orientationDiv.innerHTML="not implemented yet";
    }
    
    //relative orientation sensor
    function relativeOrientationDemo(){
        let relativeOrientationDiv = document.getElementById("relativeOrientation");
        relativeOrientationDiv.innerHTML="not implemented yet";
    }
</script>
</body>
</html>